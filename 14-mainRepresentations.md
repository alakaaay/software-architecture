# 14. Основные представления архитектуры

## a. Функциональное представление
**Назначение:** показать ключевые сервисы и их взаимодействие с пользователями.  
- Пользовательское мобильное приложение (iOS/Android).  
- API Gateway → маршрутизация и аутентификация запросов.  
- Core-сервисы:  
  - Auth Service (регистрация, вход, токены).  
  - Profile Service (данные пользователя, предпочтения).  
  - Training Service (учёт тренировок, метрики).  
  - Social Service (лента, друзья, комментарии).  
  - Gamification Service (челленджи, бейджи).  
  - Notification Service (push, e-mail).  
  - Recommendation Service (ML-модели, персонализация).  
- Интеграции: внешние фитнес-платформы (Apple Health, Google Fit), e-commerce.

## b. Информационное представление
**Назначение:** описать ключевые данные, их хранение и связи.  
- **Auth & Profile:** PostgreSQL (реляционная модель: пользователи, роли, профили).  
- **Training:** TimeSeries DB (InfluxDB; хранение метрик: шаги, пульс, GPS-треки).  
- **Social:** NoSQL (MongoDB; хранение постов, лайков, комментариев).  
- **Gamification:** PostgreSQL (правила, прогресс, достижения).  
- **Notifications:** очередь сообщений (Kafka/SQS) + кэш Redis для отслеживания статусов.  
- **Recommendations:** Neo4j (граф пользователей и интересов) + ML-модели.  

## c. Представление многозадачности (concurrency)
**Назначение:** показать, как система обрабатывает параллельные запросы.  
- Каждый сервис масштабируется горизонтально (через Kubernetes autoscaling).  
- Асинхронные события — через очередь сообщений (Kafka).  
- Training Service — массовый приём данных от устройств (batch + real-time ingestion).  
- Social Service — параллельные обновления ленты и лайков (eventual consistency через NoSQL).  
- Notifications — отдельные воркеры для массовой рассылки push/email.  
- Concurrency control:  
  - optimistic locking в PostgreSQL,  
  - версионность документов в MongoDB,  
  - очереди для упорядочивания массовых операций.  

## d. Инфраструктурное представление
**Назначение:** показать техническую платформу.  
- Развёртывание: Kubernetes (AWS/GCP/Azure).  
- CI/CD: GitLab CI + Helm charts для выката.  
- Мониторинг: Prometheus + Grafana, централизованный логинг (ELK).  
- CDN для доставки статики (картинки, медиа).  
- Multi-cloud архитектура с балансировкой нагрузки и геораспределением.  
- Storage: S3-совместимые хранилища для файлов (фото, аватары).  

## e. Представление безопасности
**Назначение:** отразить защиту данных и доступов.  
- Аутентификация и авторизация: OAuth2/OpenID Connect.  
- Шифрование: HTTPS (TLS 1.3), шифрование чувствительных данных в БД (PII).  
- RBAC (роли пользователей: пользователь, администратор, модератор).  
- API Gateway → rate limiting, WAF, защита от DDoS.  
- Secrets management: HashiCorp Vault / AWS Secrets Manager.  
- Логирование и аудит действий пользователей.  
- Соответствие GDPR: хранение согласий, удаление данных по запросу.  
