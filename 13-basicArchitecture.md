# 13. Базовая архитектура

## Общий обзор
Базовая архитектура строится на микросервисном подходе с выделенными доменными сервисами и централизованной авторизацией.  
Клиентское приложение — мобильное (iOS/Android), с взаимодействием через REST/GraphQL API и push-уведомления.  
Данные хранятся в реляционных и NoSQL БД (в зависимости от сценария).  

---

## Основные компоненты

### 1. Клиентское приложение
- **Функции:** регистрация, тренировки, социальные функции, геймификация, просмотр статистики.  
- **Качества:** высокая удобство (UX), кроссплатформенность, оффлайн-доступ с последующей синхронизацией.  

### 2. API Gateway
- **Функции:** маршрутизация запросов, аутентификация токенов, rate limiting.  
- **Качества:** безопасность, управляемость трафиком.  

### 3. Auth Service
- **Функции:** OAuth2/OpenID Connect, социальные входы (Google, Apple).  
- **БД:** реляционная (PostgreSQL).  
- **Качества:** безопасность, масштабируемость, высокая доступность.  

### 4. Client Profile Service
- **Функции:** хранение и редактирование профилей, предпочтений, уровня активности.  
- **БД:** реляционная.  
- **Качества:** согласованность данных, удобство обновлений.  

### 5. Training Service
- **Функции:** запись и хранение тренировок, подключение устройств, статистика.  
- **БД:** Timeseries DB (например, InfluxDB) для метрик тренировок.  
- **Качества:** производительность, оптимизация под большие объёмы данных.  

### 6. Social Service
- **Функции:** друзья, лента активности, комментарии, лайки.  
- **БД:** NoSQL (MongoDB).  
- **Качества:** масштабируемость, гибкость структуры.  

### 7. Gamification Service
- **Функции:** челленджи, бейджи, рейтинги.  
- **БД:** реляционная.  
- **Качества:** расширяемость, поддержка динамических правил.  

### 8. Notification Service
- **Функции:** push-уведомления, e-mail, интеграция с Firebase/Apple Push.  
- **Качества:** высокая доступность, низкая задержка.  

### 9. Recommendation Service
- **Функции:** персональные предложения тренировок, статей и промо.  
- **БД:** графовая (Neo4j) + ML-модель.  
- **Качества:** адаптивность, наблюдаемость.  

---

## Адресация атрибутов качества

- **Наблюдаемость:** централизованный логинг (ELK/Prometheus/Grafana).  
- **Масштабируемость:** микросервисы, авто-масштабирование в Kubernetes.  
- **Производительность:** оптимизация хранения (timeseries, NoSQL для социальных данных).  
- **Безопасность:** авторизация через OAuth2, HTTPS, rate limiting, шифрование данных.  
- **Удобство (UX):** оффлайн-режим, push-уведомления, персональные рекомендации.  
- **Доступность:** развертывание в облаке с отказоустойчивыми кластерами.  
- **Расширяемость:** возможность подключения новых сервисов (например, e-commerce).  

---

## Ограничения бизнес-требований
- Время отклика ≤ 200 мс для большинства API.  
- Обработка до 100k MAU (Monthly Active Users) на старте с ростом до 1M.  
- Безопасность персональных данных (соответствие GDPR).  
- Минимизация time-to-market → использование облачных PaaS (Firebase, AWS Cognito, готовые push-сервисы).  
